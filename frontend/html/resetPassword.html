<!DOCTYPE html>
<html>
  <head>
    
    <title>Reset Password</title>
    <meta content="" name="description" />
    <meta content="" name="keywords" />

    <!-- Favicons -->
    <link href="../assets/img/favicon.png" rel="icon" />
    <link href="../assets/img/apple-touch-icon.png" rel="apple-touch-icon" />
    <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>


    <link
      href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css"
      rel="stylesheet"
    />
  </head>

  <link rel="stylesheet" href="../css/styles.css" />

  <body>
    <div class="bg">
      <div class="login_form">
        <div action="#" class="form">
          <h1 class="form_title">Reset Password</h1>

          <!-- <div class="form_div">
            <input
              type="email"
              class="form_input"
              placeholder=" "
              id="resetPageEmail"
              required
            />
            <label class="form_label">Email</label>
          </div>
          <p id="resetPageEmailInnerHtml" class="innerHtml"></p> -->

          <p id="resetPageEmailInnerHtml" class="innerHtml"></p>
          <div class="form_div">
            <input
              type="password"
              class="form_input"
              placeholder=" "
              id="resetPagePassword"
              minlength="8"
              required
            />
            <label class="form_label">Password</label>
          </div>
          <p id="resetPagePasswordInnerHtml" class="innerHtml"></p>

          <div class="form_div">
            <input
              type="password"
              class="form_input"
              placeholder=" "
              id="resetReenterPagePassword"
              required
            />
            <label class="form_label">reenter Password</label>
          </div>
          <p id="resetReenterPagePasswordInnerHtml" class="innerHtml"></p>

          <div>
            <button
              class="form_button"
              type="button"
              onclick="resetPassword()"
            >
              Reset
            </button>
          </div>

          <div class="signup_button_class">
            Don't have an account? <a href="signup.html">Create One</a>
          </div>
        </div>
      </div>
    </div>

    <script src="../js/script.js"></script>
    <script src="../js/resetPassword.js"></script>
    <script>
      
        document.addEventListener("DOMContentLoaded", () => {
        alert("Hello World!");
        });
        const params = new URLSearchParams(window.location.search);
        const key = params.get("key");
        alert(key);
    
  fetch(`http://127.0.0.1:8000/getUser/${key}`, {
    method: "GET",
    headers: { Authorization: "Bearer " + localStorage.getItem("token") },
  })
    .then((response) => response.json())
    .then((responseJson) => {
      console.log({ responseJson });
      
      //token verification conditions
      if (responseJson?.detail == "Token Expired") {
        alert("token expired");
        // window.location.href = "/frontend/html/index.html";
        window.location.href = "../html/index.html";
      }
      else
      document.getElementById("resetPageEmailInnerHtml").innerHTML=responseJson?.email



    })
    .catch((error) => {
      console.log(error);
      alert("error catch", error);
    });



    </script>
  </body>
</html>
